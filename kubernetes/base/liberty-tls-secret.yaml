---
# TLS Secret for Liberty Ingress (Development/Testing Only)
#
# This file provides instructions for creating TLS secrets for the Liberty Ingress.
# Choose ONE of the following options based on your environment.
#
# =============================================================================
# OPTION 1: Generate Self-Signed Certificate (Development)
# =============================================================================
# Use this for local development and testing only.
#
# Generate certificate and key:
#
#   # Create a self-signed certificate valid for 365 days
#   openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
#     -keyout liberty-tls.key \
#     -out liberty-tls.crt \
#     -subj "/CN=liberty.local/O=Middleware Platform" \
#     -addext "subjectAltName=DNS:liberty.local,DNS:*.liberty.local"
#
#   # Create Kubernetes secret from the generated files
#   kubectl create secret tls liberty-tls-secret \
#     --namespace liberty \
#     --cert=liberty-tls.crt \
#     --key=liberty-tls.key
#
#   # Clean up local files
#   rm liberty-tls.key liberty-tls.crt
#
# =============================================================================
# OPTION 2: Use cert-manager (Recommended for all environments)
# =============================================================================
# cert-manager automatically provisions and renews certificates.
# See kubernetes/base/certificates/ for ClusterIssuer and Certificate resources.
#
# Install cert-manager:
#   kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.0/cert-manager.yaml
#
# Apply certificate resources:
#   kubectl apply -f kubernetes/base/certificates/
#
# The Certificate resource will automatically create the liberty-tls-secret.
#
# =============================================================================
# OPTION 3: Apply Pre-encoded Secret (Development Quick Start)
# =============================================================================
# For quick testing, you can apply this template with base64-encoded cert/key.
#
# WARNING: The example below uses placeholder values. Replace with real values.
#
# To encode your certificate and key:
#   cat liberty-tls.crt | base64 -w 0
#   cat liberty-tls.key | base64 -w 0
#
# Uncomment and apply the secret below after replacing placeholders:

# apiVersion: v1
# kind: Secret
# metadata:
#   name: liberty-tls-secret
#   namespace: liberty
#   labels:
#     app: liberty
#     app.kubernetes.io/name: liberty
#     app.kubernetes.io/component: tls
#     app.kubernetes.io/part-of: middleware-platform
# type: kubernetes.io/tls
# data:
#   # Base64-encoded TLS certificate (replace with your actual certificate)
#   tls.crt: |
#     LS0tLS1CRUdJTi... (base64 encoded certificate)
#   # Base64-encoded TLS private key (replace with your actual key)
#   tls.key: |
#     LS0tLS1CRUdJTi... (base64 encoded key)

# =============================================================================
# OPTION 4: One-liner for Development (Generates and applies in one command)
# =============================================================================
# This creates a self-signed cert and applies it directly to Kubernetes:
#
#   openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
#     -keyout /dev/stdout -out /dev/stdout \
#     -subj "/CN=liberty.local" \
#     -addext "subjectAltName=DNS:liberty.local" 2>/dev/null | \
#   kubectl create secret generic liberty-tls-secret \
#     --namespace liberty \
#     --from-file=tls.crt=/dev/stdin \
#     --from-file=tls.key=/dev/stdin \
#     --dry-run=client -o yaml | kubectl apply -f -
#
# Note: The one-liner above may have issues with stdin handling.
# Use Option 1 for reliability.
#
# =============================================================================
# Verification
# =============================================================================
# After creating the secret, verify it:
#
#   kubectl get secret liberty-tls-secret -n liberty -o yaml
#   kubectl describe secret liberty-tls-secret -n liberty
#
# Test the certificate:
#
#   kubectl get secret liberty-tls-secret -n liberty -o jsonpath='{.data.tls\.crt}' | \
#     base64 -d | openssl x509 -text -noout
#
# =============================================================================
# Security Notes
# =============================================================================
# - Self-signed certificates should NEVER be used in production
# - For production, use cert-manager with Let's Encrypt or your organization's CA
# - Rotate certificates before expiration (cert-manager handles this automatically)
# - Keep private keys secure and never commit them to version control
