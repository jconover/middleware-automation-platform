---
# =============================================================================
# Ansible Inventory - AWS Production (EXAMPLE)
# =============================================================================
# Copy this file to prod-aws.yml and update with your Terraform outputs:
#
#   cp prod-aws.yml.example prod-aws.yml
#   cd ../../terraform/environments/prod-aws
#   terraform output ansible_inventory
#   # Copy the IPs and endpoints into prod-aws.yml
# =============================================================================

all:
  vars:
    env_name: production
    ansible_user: ansible
    ansible_ssh_private_key_file: ~/.ssh/ansible_ed25519  # <-- Your SSH key
    ansible_python_interpreter: /usr/bin/python3

    # Liberty settings
    liberty_version: "24.0.0.1"
    liberty_install_dir: /opt/ibm/wlp
    liberty_user: liberty
    liberty_http_port: 9080
    liberty_https_port: 9443
    liberty_java_version: "17"

    # ==========================================================================
    # UPDATE THESE VALUES FROM TERRAFORM OUTPUT
    # ==========================================================================

    # Database - RDS PostgreSQL
    # Get from: terraform output db_endpoint
    postgresql_host: YOUR_RDS_ENDPOINT.us-east-1.rds.amazonaws.com  # <-- CHANGE
    postgresql_port: 5432
    postgresql_database: appdb
    postgresql_user: appuser
    postgresql_version: "15"
    # Password is auto-fetched from AWS Secrets Manager

    # Redis - ElastiCache
    # Get from: terraform output redis_endpoint
    redis_host: YOUR_REDIS_ENDPOINT.cache.amazonaws.com  # <-- CHANGE
    redis_port: 6379
    redis_version: "7"

    # AWS-specific settings
    aws_region: us-east-1  # <-- CHANGE if using different region

  children:
    liberty_servers:
      hosts:
        # Get IPs from: terraform output liberty_private_ips
        liberty-prod-01:
          ansible_host: 10.10.10.X  # <-- CHANGE to first Liberty IP
          liberty_server_name: appServer01
          liberty_jvm_heap_max: 2g
        liberty-prod-02:
          ansible_host: 10.10.11.X  # <-- CHANGE to second Liberty IP
          liberty_server_name: appServer02
          liberty_jvm_heap_max: 2g

    # No local database servers - using RDS
    database_servers:
      hosts: {}
      vars:
        postgresql_enabled: false
        redis_enabled: false

    # No local load balancers - using ALB
    load_balancers:
      hosts: {}

    # Monitoring deployed to first Liberty server
    monitoring_servers:
      hosts:
        liberty-prod-01:
          ansible_host: 10.10.10.X  # <-- CHANGE (same as liberty-prod-01)

    # Group all AWS hosts
    aws:
      children:
        liberty_servers:
