---
# =============================================================================
# Ansible Inventory - AWS Production
# =============================================================================
# This is a static inventory. For dynamic EC2 discovery, use prod-aws-ec2.yml
#
# Update the IPs after running: terraform output ansible_inventory
# =============================================================================

all:
  vars:
    env_name: production
    ansible_user: ubuntu  # Use ubuntu for initial setup, then can switch to ansible
    ansible_ssh_private_key_file: ~/.ssh/ansible_ed25519
    ansible_python_interpreter: /usr/bin/python3

    # Liberty settings
    liberty_version: "24.0.0.1"
    liberty_install_dir: /opt/ibm/wlp
    liberty_user: liberty
    liberty_http_port: 9080
    liberty_https_port: 9443
    liberty_java_version: "17"

    # =========================================================================
    # SECURITY-CRITICAL VARIABLES (REQUIRED)
    # =========================================================================
    # These passwords MUST be set via Ansible Vault for production.
    # The playbook will FAIL if these are not defined or use weak values.
    #
    # To create encrypted values:
    #   ansible-vault encrypt_string 'YourSecurePassword123!' --name 'liberty_keystore_password'
    #   ansible-vault encrypt_string 'AdminSecure456!' --name 'liberty_admin_password'
    #
    # Store encrypted values in group_vars/aws/vault.yml (create if needed)
    # =========================================================================
    # liberty_keystore_password: !vault |
    #   $ANSIBLE_VAULT;1.1;AES256
    #   [encrypted content - minimum 16 characters, no weak passwords]
    #
    # liberty_admin_password: !vault |
    #   $ANSIBLE_VAULT;1.1;AES256
    #   [encrypted content - minimum 12 characters, no weak passwords]
    #
    # liberty_admin_user: admin
    # =========================================================================

    # Database - RDS PostgreSQL
    postgresql_host: mw-prod-postgres.chuo6gkeifxo.us-east-1.rds.amazonaws.com
    postgresql_port: 5432
    postgresql_database: appdb
    postgresql_user: appuser
    postgresql_version: "15"
    # Password is fetched from AWS Secrets Manager (see liberty role)
    # Secret ARN: mw-prod/database/credentials

    # Redis - ElastiCache
    redis_host: mw-prod-redis.1jnokz.0001.use1.cache.amazonaws.com
    redis_port: 6379
    redis_version: "7"

    # AWS-specific settings
    aws_region: us-east-1

  children:
    liberty_servers:
      hosts:
        # Update these IPs from Terraform output: liberty_private_ips
        liberty-prod-01:
          ansible_host: 10.10.10.163  # Update from terraform output
          liberty_server_name: appServer01
          liberty_jvm_heap_max: 2g
        liberty-prod-02:
          ansible_host: 10.10.11.39 # Update from terraform output
          liberty_server_name: appServer02
          liberty_jvm_heap_max: 2g

    # No local database servers - using RDS
    database_servers:
      hosts: {}
      vars:
        postgresql_enabled: false
        redis_enabled: false

    # No local load balancers - using ALB
    load_balancers:
      hosts: {}

    # Monitoring can be deployed to Liberty servers or separate instance
    monitoring_servers:
      hosts:
        liberty-prod-01:
          ansible_host: 10.10.10.163

    # Group all AWS hosts
    aws:
      children:
        liberty_servers:
