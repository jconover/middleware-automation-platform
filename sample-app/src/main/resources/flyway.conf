# =============================================================================
# Flyway Configuration
# Middleware Automation Platform - Sample Application
# =============================================================================
#
# This file provides default configuration for Flyway database migrations.
# Values can be overridden via:
#   1. Environment variables (FLYWAY_URL, FLYWAY_USER, FLYWAY_PASSWORD)
#   2. Maven properties (-Dflyway.url=...)
#   3. Command line arguments (flyway -url=...)
#
# Documentation: https://documentation.red-gate.com/fd/configuration-files-184127472.html
# =============================================================================

# -----------------------------------------------------------------------------
# Database Connection (REQUIRED - must be set via environment or command line)
# -----------------------------------------------------------------------------
# Connection URL - PostgreSQL format
# Format: jdbc:postgresql://host:port/database
# Example: jdbc:postgresql://localhost:5432/middleware_db
# flyway.url=

# Database credentials
# SECURITY: Never commit actual credentials to version control
# Use environment variables or secrets management in production
# flyway.user=
# flyway.password=

# -----------------------------------------------------------------------------
# Schema Configuration
# -----------------------------------------------------------------------------
# Target schema(s) for migrations
flyway.schemas=public

# Default schema for new objects created by migrations
flyway.defaultSchema=public

# Create schemas if they don't exist
flyway.createSchemas=true

# -----------------------------------------------------------------------------
# Migration Locations
# -----------------------------------------------------------------------------
# Locations to scan for migrations
# Supports: filesystem:, classpath:, s3:, gcs:
flyway.locations=classpath:db/migration

# -----------------------------------------------------------------------------
# Naming and Encoding
# -----------------------------------------------------------------------------
# SQL migration file naming pattern
# V{version}__{description}.sql - Versioned migrations
# R__{description}.sql - Repeatable migrations
flyway.sqlMigrationPrefix=V
flyway.repeatableSqlMigrationPrefix=R
flyway.sqlMigrationSeparator=__
flyway.sqlMigrationSuffixes=.sql

# File encoding
flyway.encoding=UTF-8

# -----------------------------------------------------------------------------
# Behavior Settings
# -----------------------------------------------------------------------------
# Validate migrations on startup
flyway.validateOnMigrate=true

# Validate migration naming conventions
flyway.validateMigrationNaming=true

# Allow out-of-order migrations (useful for team development)
# Set to true for development, false for production
flyway.outOfOrder=false

# Baseline settings for existing databases
# WARNING: Only enable baselineOnMigrate for legacy database adoption
flyway.baselineOnMigrate=false
flyway.baselineVersion=0
flyway.baselineDescription=Baseline

# Clean command safety
# CRITICAL: Must be true in production to prevent accidental data loss
flyway.cleanDisabled=true

# Mixed migrations (both Java and SQL in same version)
flyway.mixed=false

# Group all pending migrations in a single transaction
flyway.group=false

# -----------------------------------------------------------------------------
# Error Handling
# -----------------------------------------------------------------------------
# Behavior when validation fails
# Valid values: CONTINUE, ABORT
flyway.ignoreMigrationPatterns=

# Ignore missing migrations when validating
flyway.ignoreMissingMigrations=false

# Ignore ignored migrations when validating
flyway.ignoreIgnoredMigrations=false

# Ignore pending migrations when validating
flyway.ignorePendingMigrations=false

# Ignore future migrations when validating
flyway.ignoreFutureMigrations=true

# -----------------------------------------------------------------------------
# Placeholder Configuration
# -----------------------------------------------------------------------------
# Enable placeholder replacement in migrations
flyway.placeholderReplacement=true

# Placeholder prefix/suffix
flyway.placeholderPrefix=${
flyway.placeholderSuffix=}

# Custom placeholders
# flyway.placeholders.myplaceholder=value

# -----------------------------------------------------------------------------
# Connection Pool
# -----------------------------------------------------------------------------
# Connection retry settings
flyway.connectRetries=3
flyway.connectRetriesInterval=120

# Lock retry settings
flyway.lockRetryCount=50

# -----------------------------------------------------------------------------
# Table Settings
# -----------------------------------------------------------------------------
# Name of the schema history table
flyway.table=flyway_schema_history

# Tablespace for the schema history table (PostgreSQL)
# flyway.tablespace=

# -----------------------------------------------------------------------------
# Callbacks
# -----------------------------------------------------------------------------
# SQL callbacks (executed at migration lifecycle events)
# flyway.callbacks=

# -----------------------------------------------------------------------------
# Oracle Specific (not applicable for PostgreSQL)
# -----------------------------------------------------------------------------
# flyway.oracleSqlplus=false

# -----------------------------------------------------------------------------
# PostgreSQL Specific
# -----------------------------------------------------------------------------
# Use advisory locks for migration locking (recommended for PostgreSQL)
# This prevents concurrent migration issues in clustered environments

# =============================================================================
# Environment-Specific Overrides
# =============================================================================
#
# Development:
#   flyway.url=jdbc:postgresql://localhost:5432/middleware_dev
#   flyway.user=developer
#   flyway.outOfOrder=true
#   flyway.cleanDisabled=false
#
# Staging:
#   flyway.url=jdbc:postgresql://staging-db.internal:5432/middleware
#   flyway.user=app_user
#   flyway.outOfOrder=false
#   flyway.cleanDisabled=true
#
# Production:
#   flyway.url=jdbc:postgresql://prod-db.internal:5432/middleware
#   flyway.user=app_user
#   flyway.outOfOrder=false
#   flyway.cleanDisabled=true
#   flyway.baselineOnMigrate=false
#
# =============================================================================
